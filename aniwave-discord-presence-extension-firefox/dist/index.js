(()=>{function u(){var o;return((o=document.getElementsByClassName("title d-title")[0])==null?void 0:o.innerText)??"Anime"}function d(){try{let t=document.getElementsByClassName("meta")[2].children[1].innerText.split(" ")[1],e=parseInt(t);if(!e)throw new Error("Duration not found");return e}catch{return 23}}function g(){var t,e;try{return((e=(t=document.getElementsByClassName("poster")[0])==null?void 0:t.children[0])==null?void 0:e.firstChild).src??"aniwave_image"}catch{return"aniwave_image"}}function p(){try{return url.split("/").at(-1).split("-").at(-1)}catch{return""}}function w(){var n;let e=((n=Array.from(document.querySelectorAll(".text-h6")).filter(o=>o.nodeName==="H1")[0])==null?void 0:n.innerText)??"Anime";return console.log(`Got title: ${e}`),e}function f(){var n;let t=Array.from(document.querySelectorAll(".text-overline")).filter(o=>o.innerText.includes("EPISODE"));if(t.length===0)return"Movie";let e=((n=t[0])==null?void 0:n.innerText.split(" ")[1])??"0";return console.log(`Got episode number: ${e}`),e}function A(){var m,l;let t=document.querySelectorAll(".v-image__image.v-image__image--cover"),e=Array.from(t).at(-1),n=(m=e==null?void 0:e.style)==null?void 0:m.cssText,o=(l=n==null?void 0:n.split('"'))==null?void 0:l.at(1);return o?(console.log(`Image URL: ${o}`),o):"aniwave_image"}function E(){return 23}var y=42069,N="http://localhost",_="/animeData",T=10*1e3,v=1e3,a="title",i="imageURL",s="episodeNumber",r="timeoutInMinutes",L=["aniwave.to/watch","kickassanime.mx"],c=window.location.href,k={aniwave:{[a]:u,[i]:g,[s]:p,[r]:d},kickassanime:{[a]:w,[i]:A,[s]:f,[r]:E}};async function x(t){await new Promise(o=>setTimeout(o,T));let e=k[t],n={[a]:e[a](),[i]:e[i](),options:{[s]:e[s](),[r]:e[r](),buttonURL:c,buttonLabel:"Watch along!"}};return console.log({metadata:n}),n}async function b(t){let e=await fetch(`${N}:${y}${_}`,{method:"POST",body:t,headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`Response not ok, status: ${e.status}`)}function D(t){return t.title&&t.imageURL}async function h(t){let e=await x(t);if(!D(e)){console.log("Invalid payload, not sending to backend");return}let n=JSON.stringify(e);console.log(`Got: ${n}`),await b(n)}async function O(t){let e=c!==window.location.href,n=["https://aniwave.to/watch","https://kickassanime.mx/"].some(o=>window.location.href.includes(o));e&&n&&(c=window.location.href,await h(t))}(async()=>L.forEach(async t=>{if(c.includes(t)){let e=t.split(".")[0];await h(e),setInterval(async()=>await O(e),v)}}))();})();
//# sourceMappingURL=index.js.map
